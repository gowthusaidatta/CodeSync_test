<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Coding Profile Stats</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen flex items-center justify-center">
  <div class="w-full max-w-4xl p-4">
    <h1 class="text-3xl font-bold mb-8 text-center">ðŸ“Š Coding Profile Stats</h1>
    
    <!-- LeetCode -->
    <div id="leetcodeCard" class="bg-gray-800 rounded-lg shadow-md p-6 mb-6">
      <h2 class="text-xl font-semibold mb-2">LeetCode</h2>
      <p>@<span id="leetcodeUsername">Loading...</span></p>
      <p>Problems Solved: <span id="leetcodeProblems">0</span></p>
      <p>Contest Rating: <span id="leetcodeRating">N/A</span></p>
      <p>Easy: <span id="leetcodeEasy">0</span></p>
      <p>Medium: <span id="leetcodeMedium">0</span></p>
      <p>Hard: <span id="leetcodeHard">0</span></p>
    </div>

    <!-- CodeChef -->
    <div id="codechefCard" class="bg-gray-800 rounded-lg shadow-md p-6 mb-6">
      <h2 class="text-xl font-semibold mb-2">CodeChef</h2>
      <p>@<span id="codechefUsername">Loading...</span></p>
      <p>Rating: <span id="codechefRating">0</span></p>
      <p>Stars: <span id="codechefStars">0</span></p>
      <p>Problems Solved: <span id="codechefSolved">0</span></p>
    </div>

    <!-- HackerRank -->
    <div id="hackerrankCard" class="bg-gray-800 rounded-lg shadow-md p-6 mb-6">
      <h2 class="text-xl font-semibold mb-2">HackerRank</h2>
      <p>@<span id="hackerrankUsername">Loading...</span></p>
      <p>Score: <span id="hackerrankScore">0</span></p>
      <p>Badges: <span id="hackerrankBadges">0</span></p>
      <p>Certifications: <span id="hackerrankCerts">0</span></p>
    </div>
  </div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const username = urlParams.get('username') || '';

    if (!username) {
      alert("No username found in query params.");
    } else {
      fetch(`https://8teu07es5h.execute-api.us-east-1.amazonaws.com/prob/get-score?username=${username}`)
        .then(res => res.json())
        .then(data => {
          // LeetCode
          const lc = data.leetcode || {};
          document.getElementById('leetcodeUsername').textContent = username;
          document.getElementById('leetcodeProblems').textContent = lc.totalSolved || 0;
          document.getElementById('leetcodeRating').textContent = lc.contestRating || "N/A";
          document.getElementById('leetcodeEasy').textContent = lc.easySolved || 0;
          document.getElementById('leetcodeMedium').textContent = lc.mediumSolved || 0;
          document.getElementById('leetcodeHard').textContent = lc.hardSolved || 0;

          // CodeChef
          const cc = data.codechef || {};
          document.getElementById('codechefUsername').textContent = username;
          document.getElementById('codechefRating').textContent = cc.rating || 0;
          document.getElementById('codechefStars').textContent = cc.stars || 0;
          document.getElementById('codechefSolved').textContent = cc.solvedCount || 0;

          // HackerRank
          const hr = data.hackerrank || {};
          document.getElementById('hackerrankUsername').textContent = username;
          document.getElementById('hackerrankScore').textContent = hr.score || 0;
          document.getElementById('hackerrankBadges').textContent = hr.badges || 0;
          document.getElementById('hackerrankCerts').textContent = hr.certifications || 0;
        })
        .catch(err => {
          console.error("Error fetching score:", err);
          alert("Failed to fetch scores.");
        });
    }
  </script>
</body>
</html>
