<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CodeSync - Results</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white font-sans">

  <div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold text-center mb-6">📊 Coding Profile Stats</h1>

    <div id="loading" class="text-center text-yellow-400">Fetching your scores...</div>
    <div id="error" class="hidden text-center text-red-500">❌ Failed to fetch scores.</div>

    <div id="results" class="grid grid-cols-1 md:grid-cols-3 gap-6 hidden">
      <!-- CodeChef -->
      <div class="bg-gray-800 p-4 rounded-xl shadow">
        <h2 class="text-xl font-bold mb-2">🥘 CodeChef</h2>
        <p>Rating: <span id="codechef_rating"></span></p>
        <p>Stars: <span id="codechef_stars"></span></p>
        <p>Problems Solved: <span id="codechef_solved"></span></p>
      </div>

      <!-- LeetCode -->
      <div class="bg-gray-800 p-4 rounded-xl shadow">
        <h2 class="text-xl font-bold mb-2">🧩 LeetCode</h2>
        <p>Problems Solved: <span id="leetcode_solved"></span></p>
        <p>Easy: <span id="leetcode_easy"></span></p>
        <p>Medium: <span id="leetcode_medium"></span></p>
        <p>Hard: <span id="leetcode_hard"></span></p>
      </div>

      <!-- HackerRank -->
      <div class="bg-gray-800 p-4 rounded-xl shadow">
        <h2 class="text-xl font-bold mb-2">💻 HackerRank</h2>
        <p>Badges: <span id="hackerrank_badges"></span></p>
        <p>Certifications: <span id="hackerrank_certifications"></span></p>
      </div>
    </div>
  </div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const leetcode = urlParams.get("leetcode");
    const codechef = urlParams.get("codechef");
    const hackerrank = urlParams.get("hackerrank");

    const apiUrl = `https://8teu07es5h.execute-api.us-east-1.amazonaws.com/prob/get-score?leetcode=${leetcode}&codechef=${codechef}&hackerrank=${hackerrank}`;

    fetch(apiUrl)
      .then(response => response.json())
      .then(data => {
        document.getElementById("loading").classList.add("hidden");
        document.getElementById("results").classList.remove("hidden");

        // CodeChef
        if (data.codechef) {
          document.getElementById("codechef_rating").textContent = data.codechef.rating || "N/A";
          document.getElementById("codechef_stars").textContent = data.codechef.stars || "N/A";
          document.getElementById("codechef_solved").textContent = data.codechef.problems_solved || "N/A";
        }

        // LeetCode
        if (data.leetcode) {
          document.getElementById("leetcode_solved").textContent = data.leetcode.problems_solved || "N/A";
          document.getElementById("leetcode_easy").textContent = data.leetcode.Easy || 0;
          document.getElementById("leetcode_medium").textContent = data.leetcode.Medium || 0;
          document.getElementById("leetcode_hard").textContent = data.leetcode.Hard || 0;
        }

        // HackerRank
        if (data.hackerrank) {
          document.getElementById("hackerrank_badges").textContent = data.hackerrank.badges || "N/A";
          document.getElementById("hackerrank_certifications").textContent = data.hackerrank.certifications || "N/A";
        }
      })
      .catch(err => {
        document.getElementById("loading").classList.add("hidden");
        document.getElementById("error").classList.remove("hidden");
        console.error("Fetch error:", err);
      });
  </script>

</body>
</html>
