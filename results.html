<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CodeSync | Results</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
  </style>
</head>
<body class="bg-gray-900 text-white min-h-screen p-4">
  <h1 class="text-3xl font-bold mb-4">üìä Coding Profile Stats</h1>

  <div id="output" class="grid gap-6 md:grid-cols-3 sm:grid-cols-1">

    <!-- LeetCode -->
    <div class="bg-gray-800 p-4 rounded-2xl shadow-md">
      <h2 class="text-xl font-semibold">LeetCode</h2>
      <p>@<span id="leetcode-username">Loading...</span></p>
      <p>Problems Solved: <span id="leetcode-problems">0</span></p>
      <p>Easy: <span id="leetcode-easy">0</span></p>
      <p>Medium: <span id="leetcode-medium">0</span></p>
      <p>Hard: <span id="leetcode-hard">0</span></p>
    </div>

    <!-- CodeChef -->
    <div class="bg-gray-800 p-4 rounded-2xl shadow-md">
      <h2 class="text-xl font-semibold">CodeChef</h2>
      <p>@<span id="codechef-username">Loading...</span></p>
      <p>Problems Solved: <span id="codechef-problems">0</span></p>
      <p>Rating: <span id="codechef-rating">0</span></p>
      <p>Stars: <span id="codechef-stars">0</span></p>
    </div>

    <!-- HackerRank -->
    <div class="bg-gray-800 p-4 rounded-2xl shadow-md">
      <h2 class="text-xl font-semibold">HackerRank</h2>
      <p>@<span id="hackerrank-username">Loading...</span></p>
      <p>Badges: <span id="hackerrank-badges">0</span></p>
    </div>

  </div>

  <script>
    async function fetchScores() {
      const leetcode = localStorage.getItem("leetcode");
      const codechef = localStorage.getItem("codechef");
      const hackerrank = localStorage.getItem("hackerrank");

      if (!leetcode || !codechef || !hackerrank) {
        alert("Missing usernames. Please go back and enter all usernames.");
        window.location.href = "index.html";
        return;
      }

      const apiURL = `https://8teu07es5h.execute-api.us-east-1.amazonaws.com/prob/get-score?leetcode=${leetcode}&codechef=${codechef}&hackerrank=${hackerrank}`;

      try {
        const res = await fetch(apiURL);
        const data = await res.json();

        // LeetCode
        document.getElementById("leetcode-username").textContent = leetcode;
        document.getElementById("leetcode-problems").textContent = data.leetcode?.problems_solved ?? "0";
        document.getElementById("leetcode-easy").textContent = data.leetcode?.Easy ?? "0";
        document.getElementById("leetcode-medium").textContent = data.leetcode?.Medium ?? "0";
        document.getElementById("leetcode-hard").textContent = data.leetcode?.Hard ?? "0";

        // CodeChef
        document.getElementById("codechef-username").textContent = codechef;
        document.getElementById("codechef-problems").textContent = data.codechef?.problems_solved ?? "0";
        document.getElementById("codechef-rating").textContent = data.codechef?.contest_rating ?? "0";
        document.getElementById("codechef-stars").textContent = data.codechef?.stars ?? "0";

        // HackerRank
        document.getElementById("hackerrank-username").textContent = hackerrank;
        document.getElementById("hackerrank-badges").textContent = data.hackerrank?.badges ?? "0";

      } catch (err) {
        console.error("Error fetching data:", err);
        alert("‚ùå Failed to fetch coding scores.");
      }
    }

    fetchScores();
  </script>
</body>
</html>
